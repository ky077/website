<!doctype html>
<html lang="zh-Hans-TW">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="英語文說寫能力快篩系統 英語口說快篩系統">
<meta name="author" content="英語文說寫能力快篩系統">
<title>英語口說快篩系統 | 英語文說寫能力快篩系統</title>
<link rel="shortcut icon" type="image/x-icon" href="./Content/images/favicon.ico">
<!-- Google Web Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@100;300;400;500;700;900&family=Noto+Sans+TC:wght@100;300;400;500;700;900&display=swap"
      rel="stylesheet">

<!-- Icon Font Stylesheet -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" rel="stylesheet">

<!-- Libraries Stylesheet --> 

<!-- Customized Bootstrap Stylesheet -->
<link rel="stylesheet" type="text/css" href="Content/css/bootstrap.css">

<!-- This web Core Stylesheet -->
<link rel="stylesheet" type="text/css" href="Content/css/styles.css">
</head>

<body>
<form>
  <!-- Spinner Start -->
  <div id="spinner" class="spinner show">
    <div class="spinner-border" role="status">
      <span
        class="visually-hidden-focusable">Loading...</span>
    </div>
  </div>
  <!-- Spinner End --> 
  <a href="#content" title="跳到主要內容" tabindex="1" class="visually-hidden-focusable sr-only-goContent">跳到主要內容</a>
  <div class="page">
    <div class="bg">
    </div>
    <div class="header">
      <div class="container">
        <div class="row">
          <div class="col">
            <h1 class="h2"> <span class="h1-1"> <span class="lang-c d-none d-lg-inline">英語文說寫能力快篩系統</span> <span class="lang-e d-none d-sm-inline">EMI Screening Test</span> </span> <span class="h1-2 text-primary float-end">英語口說快篩系統</span> </h1>
          </div>
        </div>
      </div>
    </div>
    <div class="content" id="content">
      <!-- ------- ------- ------- ------- ------- ------- ------- -->
      <div class="container-lg">
        <!-- 計時器 START -->
        <div class="test-counter">
          <div class="counter-text">
            錄音檢查時限
          </div>
          <div class="counter-time">
          </div>
        </div>
        <!-- 計時器  END  -->    
          
        <div class="row align-items-start flex-column">
          <!-- content:top start -->
          <div class="col-lg-12">
            <h2 class="text-primary text-center my-4">錄音檢查</h2>
          </div>
          <!-- content:top  end  --> 
          
          <!-- content:middle start -->
          <div class="col-lg-12 col-xl-10 m-auto">
            <!-- 說明 start -->
            <div class="text-center mb-5">
              <div class="text-start d-inline-block lh-lg">
                <i class="fa-solid fa-triangle-exclamation fa-2x text-danger mx-1"></i><br>
                進入測驗之前，請先確認您在安靜的空間操作。<br>
                為了測試設備錄音品質，請按下方[<i class="fa-solid fa-microphone text-primary mx-1" aria-hidden="true"></i>錄製檔案]按鍵並唸「<span class="text-danger g-fw-500">I’m taking a speaking test.</span>」<br>
                在本測驗中，當按下錄製檔案，會開始倒數計時且無法中斷。<br>
                錄製時，請全程配戴耳麥，並大聲地說出您的答案。<br>
                提醒您，請在3分鐘內測試完畢，倒數計時結束後，將自動跳轉下一頁。<br>
                錄製完請按[<i class="fa-solid fa-play text-primary mx-1" aria-hidden="true"></i>播放錄音]檔案聆聽您剛才的錄音，請您確認錄音檔有足夠音量後，方可按下[進入測驗]。<br>
                <br>
                ※確認錄音權限，請到[設定 &gt; 隱私權 &gt; 麥克風]進行相關設定。
              </div>
            </div>
            <!-- 說明 end--> 
            <!-- 警示 start-->
            <div class="text-danger text-center mb-3 ps-sm-3">
              <span class="ms-sm-n3">※</span>若想重新測試，<br class="d-block d-sm-none">
              請按[<i class="fa-solid fa-microphone text-danger mx-1" aria-hidden="true"></i>錄製檔案]重新錄製
            </div>
            <!-- 警示 end--> 
            <!-- 錄製檔案 start -->
            <div class="d-flex flex-column align-items-center mb-5">
              <div class="text-gray-600 mb-2 record-text">
                錄製檔案
              </div>
              <button type="button" class="record-spinner" data-sec="5">
              <svg class="record-svg" viewBox="-1 -1 34 34">
                <circle cx="16" cy="16" r="15.9155" class="record-borderBack" style=""></circle>
                <circle cx="16" cy="16" r="15.9155" class="record-borderFront" style="stroke-dasharray: 100 100;"></circle>
              </svg>
              <div class="record-count">
                5
              </div>
              </button>
            </div>
            <!-- 錄製檔案 end --> 
            <!-- 播放錄音 start -->
            <div class="text-center">
              <button type="button" class="btn btn-primary btn__playRec disabled" title="播放錄音"><i class="fa-solid fa-play me-1" aria-hidden="true"></i>播放錄音</button>
            </div>
            <!-- 播放錄音 end -->
          </div>
          <!-- content:middle  end  --> 
          
          <!-- content:bottom start -->
          <div class="col-lg-12 py-4 mt-auto text-center mb-4">
            <a href="transition1.html" class="btn btn-primary btn-lg rounded-pill px-5 start disabled" title="進入測驗">進入測驗</a>
          </div>
          <!-- content:bottom  end  -->
        </div>
      </div>
      <!-- ------- ------- ------- ------- ------- ------- ------- -->
    </div>
  </div>
</form>
<!-- ------- ------- ------- ------- ------- ------- ------- --> 
<!-- ------- ------- ------- ------- ------- ------- ------- --> 
<!-- ------- ------- ------- ------- ------- ------- ------- --> 
<!-- JavaScript Libraries --> 
<script src="Content/js/jquery-3.6.0.min.js"></script> 
<script src="Content/js/bootstrap.bundle.min.js"></script> 

<!-- This web Javascript --> 
<script src="Content/js/main.js"></script> 
<script>
$(window).on('load', function() {
    spinner();
});
    
$(document).ready(function() {
    //錄音檢查時限：3分鐘後跳轉下一頁
    let countdown = 180;
    let timerInterval = setInterval(function() {
        let minutes = Math.floor(countdown / 60);
        let seconds = countdown % 60;

        let formattedMinutes = minutes < 10 ? '0' + minutes : minutes;
        let formattedSeconds = seconds < 10 ? '0' + seconds : seconds;

        $('.counter-time').text(formattedMinutes + ':' + formattedSeconds);

        countdown--;

        if (countdown < 0) {
            clearInterval(timerInterval);
            window.location.href = 'transition1.html'; 
        }
    }, 1000); 

    
    //[錄製檔案]
    $('.record-spinner').click(function(){
        REC($(this));    
    });
    
    //[播放錄音]
    $('.btn__playRec').click(function(){
        PLAYREC('10000')   
    });
});
 
 //[錄製檔案]完的next()    
function next(){
    $('.record-spinner').find('[class$="count"]').text(0);
    
    $('.btn__playRec').removeClass('disabled');
}    
    
//播放錄音
let audio = new Audio();
let isPlaying = false;
let hasPlayed = false;
function PLAYREC(src) {
  let button_now = $('.btn__playRec'),
      button_next = $('.start');

  if (isPlaying) {
    audio.pause();
  } else {
    if (!hasPlayed || audio.ended) { 
      audio.src = src;
      hasPlayed = true;
    }
    audio.play();
  }
   
  audio.addEventListener('play', function () { //播放中
      isPlaying = true;
      
      button_now.addClass('current');                                   //增加閃爍效果 
      button_now.html('<i class="fa-solid fa-pause me-1"></i>暫停播放'); //更改按鈕狀態
      
      //顯示[下一題/完成]按鈕
      button_next.removeClass('disabled');
  });  

  audio.addEventListener('pause', function () { //播放完
    isPlaying = false;
    
    button_now.removeClass('current');                               //移除閃爍效果
    button_now.html('<i class="fa-solid fa-play me-1"></i>播放錄音'); //更改按鈕狀態
      
    //顯示[下一題/完成]按鈕、若有tooltip則清除
    button_next.removeClass('disabled');
  });  
    
  audio.addEventListener('ended', function () { //播放完
    isPlaying = false;
    
    button_now.removeClass('current');                               //移除閃爍效果
    button_now.html('<i class="fa-solid fa-play me-1"></i>播放錄音'); //更改按鈕狀態
      
    //顯示[下一題/完成]按鈕、若有tooltip則清除
    button_next.removeClass('disabled');
  });
} 
</script>
</body>
</html>
